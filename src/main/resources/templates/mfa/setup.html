<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/extras/spring-security">
<body>
<div th:replace="layout :: {}">
  <div th:fragment="content">
    <h1>Set up MFA (TOTP)</h1>
    
<p>Scan this QR code in your authenticator app, or use the secret:</p>
<p><strong th:text="${secret}">SECRET</strong></p>
<img th:src="${qrImageUrl}" alt="TOTP QR" style="max-width:200px"/>
<form th:action="@{/mfa/setup}" method="post">
  <label>One-time code
    <input type="text" name="code" required>
  </label>
  <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
  <button type="submit">Enable MFA</button>
</form>

  </div>
</div>
</body>
</html>